<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html lang="zh" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/xhtml;charset=utf-8" http-equiv="Content-Type"/>
<meta content="IE=11" http-equiv="X-UA-Compatible"/>
<meta content="Doxygen 1.11.0" name="generator"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>RflySimSDK: UEMapServe类 参考</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script src="jquery.js" type="text/javascript"></script>
<script src="dynsections.js" type="text/javascript"></script>
<script src="clipboard.js" type="text/javascript"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script src="resize.js" type="text/javascript"></script>
<script src="cookie.js" type="text/javascript"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script src="search/searchdata.js" type="text/javascript"></script>
<script src="search/search.js" type="text/javascript"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js" type="text/javascript"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="cus.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellpadding="0" cellspacing="0">
<tbody>
<tr id="projectrow">
<td id="projectlogo"><img alt="Logo" src="feisi_logo.png"/></td>
<td id="projectalign">
<div id="projectname">RflySimSDK<span id="projectnumber"> v3.06</span>
</div>
<div id="projectbrief">RflySimSDK说明文档</div>
</td>
</tr>
</tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script src="menudata.js" type="text/javascript"></script>
<script src="menu.js" type="text/javascript"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','搜索',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()">
</div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">载入中...</div>
<div class="SRStatus" id="Searching">搜索中...</div>
<div class="SRStatus" id="NoMatches">未找到</div>
</div>
</div>
</div>
</div>
<div class="navpath" id="nav-path">
<ul>
<li class="navelem"><b>RflySimSDK</b></li><li class="navelem"><b>ue</b></li><li class="navelem"><b>UEMapServe</b></li><li class="navelem"><a class="el" href="classRflySimSDK_1_1ue_1_1UEMapServe_1_1UEMapServe.html">UEMapServe</a></li> </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
<div class="summary">
<a href="#pub-methods">Public 成员函数</a> |
<a href="#pub-attribs">Public 属性</a> |
<a href="classRflySimSDK_1_1ue_1_1UEMapServe_1_1UEMapServe-members.html">所有成员列表</a> </div>
<div class="headertitle"><div class="title">UEMapServe类 参考</div></div>
</div><!--header-->
<div class="contents">
<p>三维场景地图服务器类。  
 <a href="#details">更多...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public 成员函数</h2></td></tr>
<tr class="memitem:af675f79b1748be37ea4e2c6c77a81736" id="r_af675f79b1748be37ea4e2c6c77a81736"><td align="right" class="memItemLeft" valign="top"> </td><td class="memItemRight" valign="bottom"><a class="el" href="#af675f79b1748be37ea4e2c6c77a81736">__init__</a> (self, name='')</td></tr>
<tr class="memdesc:af675f79b1748be37ea4e2c6c77a81736"><td class="mdescLeft"> </td><td class="mdescRight">初始化UEMapServe类的实例。  <br/></td></tr>
<tr class="separator:af675f79b1748be37ea4e2c6c77a81736"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:a5c318bf0ad2f34054586785f947cb172" id="r_a5c318bf0ad2f34054586785f947cb172"><td align="right" class="memItemLeft" valign="top"> </td><td class="memItemRight" valign="bottom"><a class="el" href="#a5c318bf0ad2f34054586785f947cb172">LoadPngData</a> (self, name)</td></tr>
<tr class="memdesc:a5c318bf0ad2f34054586785f947cb172"><td class="mdescLeft"> </td><td class="mdescRight">加载PNG图像和相关的TXT数据，并进行相应的处理。  <br/></td></tr>
<tr class="separator:a5c318bf0ad2f34054586785f947cb172"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:ad089471bea58e69fd7a1bb55adb2947b" id="r_ad089471bea58e69fd7a1bb55adb2947b"><td align="right" class="memItemLeft" valign="top"> </td><td class="memItemRight" valign="bottom"><a class="el" href="#ad089471bea58e69fd7a1bb55adb2947b">getTerrainAltData</a> (self, xin, yin)</td></tr>
<tr class="memdesc:ad089471bea58e69fd7a1bb55adb2947b"><td class="mdescLeft"> </td><td class="mdescRight">根据输入的X和Y坐标获取地形高度数据。  <br/></td></tr>
<tr class="separator:ad089471bea58e69fd7a1bb55adb2947b"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:aebe8cfe21b82a2bef32594f62998e866" id="r_aebe8cfe21b82a2bef32594f62998e866"><td align="right" class="memItemLeft" valign="top"> </td><td class="memItemRight" valign="bottom"><a class="el" href="#aebe8cfe21b82a2bef32594f62998e866">outTerrainPoint</a> (self)</td></tr>
<tr class="memdesc:aebe8cfe21b82a2bef32594f62998e866"><td class="mdescLeft"> </td><td class="mdescRight">生成地形点云。  <br/></td></tr>
<tr class="separator:aebe8cfe21b82a2bef32594f62998e866"><td class="memSeparator" colspan="2"> </td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public 属性</h2></td></tr>
<tr class="memitem:ac2072352ec3ad6d1431a5c6ada743685" id="r_ac2072352ec3ad6d1431a5c6ada743685"><td align="right" class="memItemLeft" valign="top"> </td><td class="memItemRight" valign="bottom"><a class="el" href="#ac2072352ec3ad6d1431a5c6ada743685">PosOffsetX</a></td></tr>
<tr class="memdesc:ac2072352ec3ad6d1431a5c6ada743685"><td class="mdescLeft"> </td><td class="mdescRight">X方向的偏移量。  <br/></td></tr>
<tr class="separator:ac2072352ec3ad6d1431a5c6ada743685"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:a6ce4d402da64e848b34711c21e176506" id="r_a6ce4d402da64e848b34711c21e176506"><td align="right" class="memItemLeft" valign="top"> </td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ce4d402da64e848b34711c21e176506">PosScaleX</a></td></tr>
<tr class="memdesc:a6ce4d402da64e848b34711c21e176506"><td class="mdescLeft"> </td><td class="mdescRight">X方向的缩放比例。  <br/></td></tr>
<tr class="separator:a6ce4d402da64e848b34711c21e176506"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:a555a3924047c792a0d6ec86e9fc98f20" id="r_a555a3924047c792a0d6ec86e9fc98f20"><td align="right" class="memItemLeft" valign="top"> </td><td class="memItemRight" valign="bottom"><a class="el" href="#a555a3924047c792a0d6ec86e9fc98f20">PosOffsetY</a></td></tr>
<tr class="memdesc:a555a3924047c792a0d6ec86e9fc98f20"><td class="mdescLeft"> </td><td class="mdescRight">Y方向的偏移量。  <br/></td></tr>
<tr class="separator:a555a3924047c792a0d6ec86e9fc98f20"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:aba39888f7c3eaf124917a1c37dd5bb6e" id="r_aba39888f7c3eaf124917a1c37dd5bb6e"><td align="right" class="memItemLeft" valign="top"> </td><td class="memItemRight" valign="bottom"><a class="el" href="#aba39888f7c3eaf124917a1c37dd5bb6e">PosScaleY</a></td></tr>
<tr class="memdesc:aba39888f7c3eaf124917a1c37dd5bb6e"><td class="mdescLeft"> </td><td class="mdescRight">Y方向的缩放比例。  <br/></td></tr>
<tr class="separator:aba39888f7c3eaf124917a1c37dd5bb6e"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:acc3139dfa8a349ddea139df2fa843434" id="r_acc3139dfa8a349ddea139df2fa843434"><td align="right" class="memItemLeft" valign="top"> </td><td class="memItemRight" valign="bottom"><a class="el" href="#acc3139dfa8a349ddea139df2fa843434">xMax</a></td></tr>
<tr class="memdesc:acc3139dfa8a349ddea139df2fa843434"><td class="mdescLeft"> </td><td class="mdescRight">地图的最大X值。  <br/></td></tr>
<tr class="separator:acc3139dfa8a349ddea139df2fa843434"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:a038056d25e751ffb5b3a061a0a27ac99" id="r_a038056d25e751ffb5b3a061a0a27ac99"><td align="right" class="memItemLeft" valign="top"> </td><td class="memItemRight" valign="bottom"><a class="el" href="#a038056d25e751ffb5b3a061a0a27ac99">yMax</a></td></tr>
<tr class="memdesc:a038056d25e751ffb5b3a061a0a27ac99"><td class="mdescLeft"> </td><td class="mdescRight">地图的最大Y值。  <br/></td></tr>
<tr class="separator:a038056d25e751ffb5b3a061a0a27ac99"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:a43049aeb838b2c761d0784f9fe0ef3c2" id="r_a43049aeb838b2c761d0784f9fe0ef3c2"><td align="right" class="memItemLeft" valign="top"> </td><td class="memItemRight" valign="bottom"><a class="el" href="#a43049aeb838b2c761d0784f9fe0ef3c2">binmap</a></td></tr>
<tr class="memdesc:a43049aeb838b2c761d0784f9fe0ef3c2"><td class="mdescLeft"> </td><td class="mdescRight">存储地形数据的二进制数组。  <br/></td></tr>
<tr class="separator:a43049aeb838b2c761d0784f9fe0ef3c2"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:a8ee6ea691a0a798a14932b2218b4fc1e" id="r_a8ee6ea691a0a798a14932b2218b4fc1e"><td align="right" class="memItemLeft" valign="top"> </td><td class="memItemRight" valign="bottom"><a class="el" href="#a8ee6ea691a0a798a14932b2218b4fc1e">GPS</a></td></tr>
<tr class="memdesc:a8ee6ea691a0a798a14932b2218b4fc1e"><td class="mdescLeft"> </td><td class="mdescRight">存储GPS数据的列表（如果存在）。  <br/></td></tr>
<tr class="separator:a8ee6ea691a0a798a14932b2218b4fc1e"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:a74742cb5c8e2ac354a60cb73383d8176" id="r_a74742cb5c8e2ac354a60cb73383d8176"><td align="right" class="memItemLeft" valign="top"> </td><td class="memItemRight" valign="bottom"><a class="el" href="#a74742cb5c8e2ac354a60cb73383d8176">rows</a></td></tr>
<tr class="memdesc:a74742cb5c8e2ac354a60cb73383d8176"><td class="mdescLeft"> </td><td class="mdescRight">地形网格的行数  <br/></td></tr>
<tr class="separator:a74742cb5c8e2ac354a60cb73383d8176"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:a2236b72f560276e1c4ca3409b8b3ecb5" id="r_a2236b72f560276e1c4ca3409b8b3ecb5"><td align="right" class="memItemLeft" valign="top"> </td><td class="memItemRight" valign="bottom"><a class="el" href="#a2236b72f560276e1c4ca3409b8b3ecb5">columns</a></td></tr>
<tr class="memdesc:a2236b72f560276e1c4ca3409b8b3ecb5"><td class="mdescLeft"> </td><td class="mdescRight">地形网格的列数  <br/></td></tr>
<tr class="separator:a2236b72f560276e1c4ca3409b8b3ecb5"><td class="memSeparator" colspan="2"> </td></tr>
</table>
<a id="details" name="details"></a><h2 class="groupheader">详细描述</h2>
<div class="textblock"><p>三维场景地图服务器类。 </p>
<p>此类通过读取地形灰度图和对应的元数据来获取指定位置的海拔高度。</p>
<p>元数据中包含对图像坐标系与地理坐标系转换参数，以及图像的地理范围。</p>
<p>点云数据供其他节点订阅。 </p><dl class="section author"><dt>作者</dt><dd></dd></dl>
<dl class="section date"><dt>日期</dt><dd>2024.06.03 </dd></dl>
</div><h2 class="groupheader">构造及析构函数说明</h2>
<a id="af675f79b1748be37ea4e2c6c77a81736" name="af675f79b1748be37ea4e2c6c77a81736"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af675f79b1748be37ea4e2c6c77a81736">◆ </a></span>__init__()</h2>
<div class="memitem">
<div class="memproto">
<table class="memname">
<tr>
<td class="memname">__init__ </td>
<td>(</td>
<td class="paramtype"></td> <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
</tr>
<tr>
<td class="paramkey"></td>
<td></td>
<td class="paramtype"></td> <td class="paramname"><span class="paramname"><em>name</em></span><span class="paramdefsep"> = </span><span class="paramdefval">''</span> )</td>
</tr>
</table>
</div><div class="memdoc">
<p>初始化UEMapServe类的实例。 </p>
<ul>
<li><a class="anchor" id="__init__"></a><dl class="params"><dt>参数</dt><dd>
<table class="params">
<tr><td class="paramname">name</td><td>地形图文件的名称（可选）。如果未提供名称，将初始化空的地形数据。 </td></tr>
</table>
</dd>
</dl>
</li>
</ul>
</div>
</div>
<h2 class="groupheader">成员函数说明</h2>
<a id="ad089471bea58e69fd7a1bb55adb2947b" name="ad089471bea58e69fd7a1bb55adb2947b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad089471bea58e69fd7a1bb55adb2947b">◆ </a></span>getTerrainAltData()</h2>
<div class="memitem">
<div class="memproto">
<table class="memname">
<tr>
<td class="memname">getTerrainAltData </td>
<td>(</td>
<td class="paramtype"></td> <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
</tr>
<tr>
<td class="paramkey"></td>
<td></td>
<td class="paramtype"></td> <td class="paramname"><span class="paramname"><em>xin</em></span>, </td>
</tr>
<tr>
<td class="paramkey"></td>
<td></td>
<td class="paramtype"></td> <td class="paramname"><span class="paramname"><em>yin</em></span> )</td>
</tr>
</table>
</div><div class="memdoc">
<p>根据输入的X和Y坐标获取地形高度数据。 </p>
<ul>
<li><a class="anchor" id="getTerrainAltData"></a> <br/>
<dl class="params"><dt>参数</dt><dd>
<table class="params">
<tr><td class="paramname">xin</td><td>输入的X坐标值。 </td></tr>
<tr><td class="paramname">yin</td><td>输入的Y坐标值。 </td></tr>
</table>
</dd>
</dl>
<dl class="section return"><dt>返回</dt><dd>返回插值后的地形高度数据。 </dd></dl>
<dl class="exception"><dt>异常</dt><dd>
<table class="exception">
<tr><td class="paramname">无异常抛出。</td><td></td></tr>
</table>
</dd>
</dl>
<pre class="fragment">解析
    if len(self.binmap) == 0:
        print("Please load a map first!")
        sys.exit(0)
        检查是否已经加载了地形数据，如果没有加载则提示用户并退出程序。

    intCol = (xin * 100 - self.PosOffsetX) / self.PosScaleX + 1
    intRow = (yin * 100 - self.PosOffsetY) / self.PosScaleY + 1
        计算输入坐标在地形图中的对应列和行。

    intColInt = int(intCol)
    intRowInt = int(intRow)
        获取整数部分的列和行。

    a = intCol - intColInt
    b = intRow - intRowInt
        计算列和行的小数部分，用于双线性插值。

    intRowInt1 = intRowInt + 1
    intColInt1 = intColInt + 1
        获取下一列和行的索引，用于插值计算。

    m = self.rows
    n = self.columns
        获取地形图的行数和列数。

    if intColInt &lt; 1:
        intColInt = 1
        intColInt1 = 1
        a = 0
        确保列索引在有效范围内，如果小于1则重置为1，并将小数部分设为0。

    if intColInt &gt;= n:
        intColInt = n
        intColInt1 = intColInt
        a = 0
        确保列索引在有效范围内，如果大于等于列数则重置为最大列索引，并将小数部分设为0。

    if intRowInt &lt; 1:
        intRowInt = 1
        intRowInt1 = 1
        b = 0
        确保行索引在有效范围内，如果小于1则重置为1，并将小数部分设为0。

    if intRowInt &gt;= m:
        intRowInt = m
        intRowInt1 = intRowInt
        b = 0
        确保行索引在有效范围内，如果大于等于行数则重置为最大行索引，并将小数部分设为0。

    binmap = self.binmap
    intRowInt = intRowInt - 1
    intColInt = intColInt - 1
    intRowInt1 = intRowInt1 - 1
    intColInt1 = intColInt1 - 1
        调整索引值以匹配数组索引从0开始的特点。

    zz = (binmap[intRowInt, intColInt] * (1 - b) * (1 - a) +
        binmap[intRowInt1, intColInt] * b * (1 - a) +
        binmap[intRowInt, intColInt1] * (1 - b) * a +
        binmap[intRowInt1, intColInt1] * b * a)
        计算双线性插值，得到输入坐标对应的地形高度。

    return zz
        返回插值后的地形高度数据。
</pre> </li>
</ul>
<div class="dynheader closed" id="dynsection-0" onclick="return dynsection.toggleVisibility(this)" style="cursor:pointer;">
<img alt="+" id="dynsection-0-trigger" src="closed.png"/> 这是这个函数的调用关系图:</div>
<div class="dynsummary" id="dynsection-0-summary" style="display:block;">
</div>
<div class="dyncontent" id="dynsection-0-content" style="display:none;">
<div class="center"><iframe frameborder="0" height="38" scrolling="no" src="classRflySimSDK_1_1ue_1_1UEMapServe_1_1UEMapServe_ad089471bea58e69fd7a1bb55adb2947b_icgraph.svg" width="290"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<a id="a5c318bf0ad2f34054586785f947cb172" name="a5c318bf0ad2f34054586785f947cb172"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c318bf0ad2f34054586785f947cb172">◆ </a></span>LoadPngData()</h2>
<div class="memitem">
<div class="memproto">
<table class="memname">
<tr>
<td class="memname">LoadPngData </td>
<td>(</td>
<td class="paramtype"></td> <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
</tr>
<tr>
<td class="paramkey"></td>
<td></td>
<td class="paramtype"></td> <td class="paramname"><span class="paramname"><em>name</em></span> )</td>
</tr>
</table>
</div><div class="memdoc">
<p>加载PNG图像和相关的TXT数据，并进行相应的处理。 </p>
<ul>
<li><a class="anchor" id="LoadPngData"></a><dl class="params"><dt>参数</dt><dd>
<table class="params">
<tr><td class="paramname">name</td><td>地形图文件的名称。 </td></tr>
</table>
</dd>
</dl>
<dl class="section return"><dt>返回</dt><dd>无返回值。 </dd></dl>
<dl class="exception"><dt>异常</dt><dd>
<table class="exception">
<tr><td class="paramname">无异常抛出。</td><td><a class="anchor" id="LoadPngData_anchor"></a> <br/>
</td></tr>
</table>
</dd>
</dl>
<pre class="fragment">解析
    psp_path = os.environ.get('PSP_PATH')
    获取指定的环境变量 PSP_PATH  
    if psp_path is None:  
        psp_path=r'C:\PX4PSP'
        如果没有成功获取路径，就使用PX4PSP默认路径
    PSPMapPath=psp_path+ r"\CopterSim\external\map"
    
    fileLoc=os.path.join(sys.path[0],name)
    fileLocTxt = fileLoc+'.txt'
    if not os.path.exists(fileLocTxt): 
        fileLoc=os.path.join(PSPMapPath,name)
        fileLocTxt = fileLoc+'.txt'
    
    如果当前目录没搜到，就搜索CopterSim目录
        if not os.path.exists(fileLocTxt): 
            print("Failed to find file ",fileLocTxt)
            sys.exit(0)
        
        CopterSim目录也没搜到就报错
    
    txtFile = open(fileLocTxt)
    line = txtFile.readline()
    txtFile.close()
        打开.txt文件并读取第一行内容，然后关闭文件。

    m_readData = line.split(',')
    if len(m_readData) != 9:
        sys.exit(0)
        将读取的行内容按照逗号分割，并检查分割后的数据是否正好为9个元素，如果不是则退出程序。

    for i in range(len(m_readData)):
        m_readData[i] = float(m_readData[i])
        将分割后的字符串数据转换为浮点数。

    rowmap = cv2.imread(fileLocPng, cv2.IMREAD_ANYDEPTH)
    rowmap = rowmap.astype(np.float32)
    rowmap = rowmap - 32768
        读取.png文件并将其转换为浮点型数组，然后将所有像素值减去32768以调整数据范围。

    rows = np.size(rowmap, 0)
    columns = np.size(rowmap, 1)
        获取rowmap的行数和列数。

    PosScaleX = (m_readData[0] - m_readData[3]) / (columns - 1)
    PosScaleY = (m_readData[1] - m_readData[4]) / (rows - 1)
        计算X和Y方向的缩放比例。

    PosOffsetX = m_readData[3]
    PosOffsetY = m_readData[4]
        设定X和Y方向的偏移量。

    intCol = int((m_readData[6] - PosOffsetX) / PosScaleX)
    intRow = int((m_readData[7] - PosOffsetY) / PosScaleY)
        计算目标位置在图像中的行和列。

    heightInit = float(rowmap[0, 0])
    heightFirst = float(rowmap[rows - 1, columns - 1])
    heightThird = float(rowmap[intRow, intCol])
        获取初始高度、末端高度和目标位置的高度。

    if abs(heightThird - heightFirst) &lt;= abs(heightThird - heightInit):
        if abs(heightInit - heightThird) &gt; 10:
            PosScaleZ = (m_readData[5] - m_readData[8]) / (heightInit - heightThird)
        else:
            PosScaleZ = 1
    else:
        if abs(heightThird - heightFirst) &gt; 10:
            PosScaleZ = (m_readData[2] - m_readData[8]) / (heightFirst - heightThird)
        else:
            PosScaleZ = 1
        根据高度差计算Z方向的缩放比例。

    intPosInitZ = heightInit
    PosOffsetZ = m_readData[5]
        设定初始高度和Z方向的偏移量。

    self.PosOffsetX = PosOffsetX
    self.PosScaleX = PosScaleX
    self.PosOffsetY = PosOffsetY
    self.PosScaleY = PosScaleY
    self.xMax = abs(m_readData[0] / 100)
    self.yMax = abs(m_readData[1] / 100)
        将计算结果赋值给类的属性。
</pre> </li>
</ul>
</div>
</div>
<a id="aebe8cfe21b82a2bef32594f62998e866" name="aebe8cfe21b82a2bef32594f62998e866"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebe8cfe21b82a2bef32594f62998e866">◆ </a></span>outTerrainPoint()</h2>
<div class="memitem">
<div class="memproto">
<table class="memname">
<tr>
<td class="memname">outTerrainPoint </td>
<td>(</td>
<td class="paramtype"></td> <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
<td></td>
</tr>
</table>
</div><div class="memdoc">
<p>生成地形点云。 </p>
<ul>
<li><a class="anchor" id="outTerrainPoint"></a> <br/>
<dl class="section return"><dt>返回</dt><dd>point_cloud_data（元组列表）：包含点云数据的列表。 </dd></dl>
<dl class="exception"><dt>异常</dt><dd>
<table class="exception">
<tr><td class="paramname">无异常抛出。</td><td></td></tr>
</table>
</dd>
</dl>
<pre class="fragment">该方法遍历地形网格中的每个单元格，计算对应的实际坐标（x, y），并使用
getTerrainAltData方法获取这些坐标的高度（h）。结果是一个包含（x, y, h）
元组的列表，代表地形。</pre> </li>
</ul>
<div class="dynheader closed" id="dynsection-1" onclick="return dynsection.toggleVisibility(this)" style="cursor:pointer;">
<img alt="+" id="dynsection-1-trigger" src="closed.png"/> 函数调用图:</div>
<div class="dynsummary" id="dynsection-1-summary" style="display:block;">
</div>
<div class="dyncontent" id="dynsection-1-content" style="display:none;">
<div class="center"><iframe frameborder="0" height="54" scrolling="no" src="classRflySimSDK_1_1ue_1_1UEMapServe_1_1UEMapServe_aebe8cfe21b82a2bef32594f62998e866_cgraph.svg" width="395"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<h2 class="groupheader">类成员变量说明</h2>
<a id="a43049aeb838b2c761d0784f9fe0ef3c2" name="a43049aeb838b2c761d0784f9fe0ef3c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43049aeb838b2c761d0784f9fe0ef3c2">◆ </a></span>binmap</h2>
<div class="memitem">
<div class="memproto">
<table class="memname">
<tr>
<td class="memname">binmap</td>
</tr>
</table>
</div><div class="memdoc">
<p>存储地形数据的二进制数组。 </p>
</div>
</div>
<a id="a2236b72f560276e1c4ca3409b8b3ecb5" name="a2236b72f560276e1c4ca3409b8b3ecb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2236b72f560276e1c4ca3409b8b3ecb5">◆ </a></span>columns</h2>
<div class="memitem">
<div class="memproto">
<table class="memname">
<tr>
<td class="memname">columns</td>
</tr>
</table>
</div><div class="memdoc">
<p>地形网格的列数 </p>
</div>
</div>
<a id="a8ee6ea691a0a798a14932b2218b4fc1e" name="a8ee6ea691a0a798a14932b2218b4fc1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ee6ea691a0a798a14932b2218b4fc1e">◆ </a></span>GPS</h2>
<div class="memitem">
<div class="memproto">
<table class="memname">
<tr>
<td class="memname">GPS</td>
</tr>
</table>
</div><div class="memdoc">
<p>存储GPS数据的列表（如果存在）。 </p>
</div>
</div>
<a id="ac2072352ec3ad6d1431a5c6ada743685" name="ac2072352ec3ad6d1431a5c6ada743685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2072352ec3ad6d1431a5c6ada743685">◆ </a></span>PosOffsetX</h2>
<div class="memitem">
<div class="memproto">
<table class="memname">
<tr>
<td class="memname">PosOffsetX</td>
</tr>
</table>
</div><div class="memdoc">
<p>X方向的偏移量。 </p>
</div>
</div>
<a id="a555a3924047c792a0d6ec86e9fc98f20" name="a555a3924047c792a0d6ec86e9fc98f20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a555a3924047c792a0d6ec86e9fc98f20">◆ </a></span>PosOffsetY</h2>
<div class="memitem">
<div class="memproto">
<table class="memname">
<tr>
<td class="memname">PosOffsetY</td>
</tr>
</table>
</div><div class="memdoc">
<p>Y方向的偏移量。 </p>
</div>
</div>
<a id="a6ce4d402da64e848b34711c21e176506" name="a6ce4d402da64e848b34711c21e176506"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ce4d402da64e848b34711c21e176506">◆ </a></span>PosScaleX</h2>
<div class="memitem">
<div class="memproto">
<table class="memname">
<tr>
<td class="memname">PosScaleX</td>
</tr>
</table>
</div><div class="memdoc">
<p>X方向的缩放比例。 </p>
</div>
</div>
<a id="aba39888f7c3eaf124917a1c37dd5bb6e" name="aba39888f7c3eaf124917a1c37dd5bb6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba39888f7c3eaf124917a1c37dd5bb6e">◆ </a></span>PosScaleY</h2>
<div class="memitem">
<div class="memproto">
<table class="memname">
<tr>
<td class="memname">PosScaleY</td>
</tr>
</table>
</div><div class="memdoc">
<p>Y方向的缩放比例。 </p>
</div>
</div>
<a id="a74742cb5c8e2ac354a60cb73383d8176" name="a74742cb5c8e2ac354a60cb73383d8176"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74742cb5c8e2ac354a60cb73383d8176">◆ </a></span>rows</h2>
<div class="memitem">
<div class="memproto">
<table class="memname">
<tr>
<td class="memname">rows</td>
</tr>
</table>
</div><div class="memdoc">
<p>地形网格的行数 </p>
</div>
</div>
<a id="acc3139dfa8a349ddea139df2fa843434" name="acc3139dfa8a349ddea139df2fa843434"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc3139dfa8a349ddea139df2fa843434">◆ </a></span>xMax</h2>
<div class="memitem">
<div class="memproto">
<table class="memname">
<tr>
<td class="memname">xMax</td>
</tr>
</table>
</div><div class="memdoc">
<p>地图的最大X值。 </p>
</div>
</div>
<a id="a038056d25e751ffb5b3a061a0a27ac99" name="a038056d25e751ffb5b3a061a0a27ac99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a038056d25e751ffb5b3a061a0a27ac99">◆ </a></span>yMax</h2>
<div class="memitem">
<div class="memproto">
<table class="memname">
<tr>
<td class="memname">yMax</td>
</tr>
</table>
</div><div class="memdoc">
<p>地图的最大Y值。 </p>
</div>
</div>
<hr/>该类的文档由以下文件生成:<ul>
<li>ue/<a class="el" href="UEMapServe_8py.html">UEMapServe.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
制作者 <a href="https://www.doxygen.org/index.html"><img alt="doxygen" class="footer" height="31" src="doxygen.svg" width="104"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
